<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>CLAUDE.md â€¢ riemtan</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="CLAUDE.md"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">riemtan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="articles/riemtan.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/performance-benchmarks.html">Performance Benchmarking and Optimization</a></li>
    <li><a class="dropdown-item" href="articles/using-parquet.html">Using Parquet Storage for Large Datasets</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nicoesve/riemtan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>CLAUDE.md</h1>
      <small class="dont-index">Source: <a href="https://github.com/nicoesve/riemtan/blob/HEAD/CLAUDE.md" class="external-link"><code>CLAUDE.md</code></a></small>
    </div>

<div id="claudemd" class="section level1">

<p>This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.</p>
<div class="section level2">
<h2 id="repository-overview">Repository Overview<a class="anchor" aria-label="anchor" href="#repository-overview"></a></h2>
<p><code>riemtan</code> is an R package that implements Riemannian metrics for symmetric positive definite (SPD) matrices. It provides tools for computing logarithmic and exponential maps, vectorization operations, and statistical analyses on the manifold of SPD matrices.</p>
<p>The package implements five metrics: - Affine Invariant Riemannian Metric (AIRM) - Log-Euclidean - Euclidean<br>
- Log-Cholesky - Bures-Wasserstein</p>
</div>
<div class="section level2">
<h2 id="development-commands">Development Commands<a class="anchor" aria-label="anchor" href="#development-commands"></a></h2>
<div class="section level3">
<h3 id="build-and-check">Build and Check<a class="anchor" aria-label="anchor" href="#build-and-check"></a></h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Build the package</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">R</span> CMD build .</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># Check the package (includes running tests)</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="ex">R</span> CMD check riemtan_<span class="pp">*</span>.tar.gz</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># Install the package from source</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="ex">R</span> CMD INSTALL .</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a></h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Run all tests</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="ex">Rscript</span> <span class="at">-e</span> <span class="st">"testthat::test_package('riemtan')"</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># Run tests interactively in R</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="ex">R</span> <span class="at">-e</span> <span class="st">"devtools::test()"</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co"># Run a specific test file</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="ex">Rscript</span> <span class="at">-e</span> <span class="st">"testthat::test_file('tests/testthat/test-csupersample.R')"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a></h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Generate documentation with roxygen2</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="ex">Rscript</span> <span class="at">-e</span> <span class="st">"devtools::document()"</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># Build package website with pkgdown</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="ex">Rscript</span> <span class="at">-e</span> <span class="st">"pkgdown::build_site()"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="development-workflow">Development Workflow<a class="anchor" aria-label="anchor" href="#development-workflow"></a></h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Load package for development</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="ex">R</span> <span class="at">-e</span> <span class="st">"devtools::load_all()"</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># Check package without building vignettes</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="ex">R</span> <span class="at">-e</span> <span class="st">"devtools::check(vignettes = FALSE)"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="code-architecture">Code Architecture<a class="anchor" aria-label="anchor" href="#code-architecture"></a></h2>
<div class="section level3">
<h3 id="core-structure">Core Structure<a class="anchor" aria-label="anchor" href="#core-structure"></a></h3>
<p>The package uses a hybrid R/C++ architecture:</p>
<ol style="list-style-type: decimal"><li>
<strong>R Interface Layer</strong> (<code>R/</code> directory):
<ul><li>Each metric has its own file (e.g., <code>airm.R</code>, <code>log_euclidean.R</code>)</li>
<li>Provides user-facing functions that validate inputs and call C++ implementations</li>
<li>Functions follow naming pattern: <code>{metric}_{operation}</code> (e.g., <code>airm_log</code>, <code>airm_exp</code>)</li>
</ul></li>
<li>
<strong>C++ Computation Layer</strong> (<code>src/</code> directory):
<ul><li>Optimized implementations using Rcpp and RcppArmadillo</li>
<li>Each metric has corresponding C++ file (e.g., <code>airm_cpp.cpp</code>)</li>
<li>Handles heavy matrix computations for performance</li>
</ul></li>
<li>
<strong>R6 Class System</strong>:
<ul><li>
<code>CSample</code>: Main class for handling collections of SPD matrices</li>
<li>
<code>CSuperSample</code>: Extends CSample for hierarchical data structures</li>
<li>
<code>TangentImageHandler</code>: Manages tangent space computations</li>
</ul></li>
</ol></div>
<div class="section level3">
<h3 id="key-components">Key Components<a class="anchor" aria-label="anchor" href="#key-components"></a></h3>
<ul><li>
<strong>Metric Functions</strong>: Each metric provides four core operations:
<ul><li>
<code>*_log</code>: Logarithmic map (manifold to tangent space)</li>
<li>
<code>*_exp</code>: Exponential map (tangent space to manifold)</li>
<li>
<code>*_vec</code>: Vectorization (matrix to vector)</li>
<li>
<code>*_unvec</code>: Inverse vectorization (vector to matrix)</li>
</ul></li>
<li>
<strong>Statistical Operations</strong>:
<ul><li>Frechet mean computation (<code>compute_frechet_mean</code>)</li>
<li>Sample variation and covariance calculations</li>
<li>Handled through CSample class methods</li>
</ul></li>
<li>
<strong>Matrix Package Integration</strong>:
<ul><li>Uses <code>Matrix</code> package for sparse/dense matrix operations</li>
<li>Matrices are typically stored as <code>dppMatrix</code> or <code>dspMatrix</code> classes</li>
<li>Functions use <code>pack()</code> for symmetric matrix storage</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a></h3>
<p>Critical R packages: - <code>Matrix</code>: Core matrix operations - <code>R6</code>: Object-oriented programming - <code>Rcpp</code>/<code>RcppArmadillo</code>: C++ integration - <code>matrixStats</code>: Efficient matrix statistics</p>
</div>
</div>
<div class="section level2">
<h2 id="important-notes">Important Notes<a class="anchor" aria-label="anchor" href="#important-notes"></a></h2>
<ul><li>All SPD matrices must be validated before operations</li>
<li>The package assumes matrices are stored in packed symmetric format when possible</li>
<li>C++ functions expect dense matrices; conversion happens at the R interface</li>
<li>Test files should follow the pattern <code>test-*.R</code> in <code>tests/testthat/</code>
</li>
</ul></div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicolas Escobar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

